<!--
Copyright (c) 2015 Preston Landers. All rights reserved.
This code may only be used under the BSD style license found at http://speakur.github.io/LICENSE.txt
The complete set of authors may be found at http://speakur.github.io/AUTHORS.txt
The complete set of contributors may be found at http://speakur.github.io/CONTRIBUTORS.txt
-->
<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../firebase-element/firebase-element.html">
<link rel="import" href="speakur-compose.html">
<link rel="import" href="speakur-post-set.html">

<!--
<link rel="import" href="speakur-lang-select.html">
-->


<polymer-element
    name="speakur-thread-view"
    extends="speakur-base"
    attributes="firebaseLocation threadId postCount">
    <template>
        <style>
        </style>

        <firebase-element
                id="dbThread" location="{{ threadLocation(firebaseLocation,threadId) }}"
                data="{{thread}}"></firebase-element>

        <div layout vertical>
<!--
            <speakur-lang-select></speakur-lang-select>
-->

            <speakur-compose
                id="threadCompose"
                threadId="{{threadId}}"
                replyTo="{{threadId}}"
                firebaseLocation="{{firebaseLocation}}">
            </speakur-compose>

            <div>
                <span>
                    Discussion: {{thread.title}}
                </span>
                <span>
                    <a target="_blank" href="{{thread.href}}">(link)</a>
                </span>
                <span>
                    Created: {{thread.created | formatTimestamp}}
                </span>
            </div>

            <speakur-post-set
                firebaseLocation="{{firebaseLocation}}"
                level="0"
                threadId="{{threadId}}"
                parentId="{{threadId}}"></speakur-post-set>
        </div>
    </template>
    <script>
        Polymer({
            threadLocation: function (firebaseLocation, threadId) {
                if (!firebaseLocation) { return ''; }
                if (!threadId) { return ''; }
                return firebaseLocation + "/threads/" + threadId;
            }

        });
    </script>
</polymer-element>
