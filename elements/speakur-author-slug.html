<!--
Copyright (c) 2015 Preston Landers. All rights reserved.
This code may only be used under the BSD style license found at http://speakur.github.io/LICENSE.txt
The complete set of authors may be found at http://speakur.github.io/AUTHORS.txt
The complete set of contributors may be found at http://speakur.github.io/CONTRIBUTORS.txt
-->
<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="speakur-author-img.html">

<polymer-element
    name="speakur-author-slug"
    extends="speakur-base"
    attributes="author showPicture imgHeight imgWidth">
    <template>
        <style>

            :host {
                /*margin-left: 6px;*/
                margin-right: 8px;
            }

            .deleted {
                font-style: italic;
                opacity: 0.9;
            }

            .anon {
                /*font-style: italic;*/
                opacity: 0.8;
            }
        </style>
        <div layout horizontal center>
            <template if="{{showPicture}}">
                <speakur-author-img
                    author="{{author}}"
                    width="{{imgWidth}}"
                    height="{{imgHeight}}">
                </speakur-author-img>
            </template>
            <span class="username {{ {anon: is_anon, deleted: is_del } | tokenList }}">
                {{ showUsername(author) }}
            </span>
        </div>

    </template>
    <script>
        Polymer({
            imgHeight: 24,
            imgWidth: 24,
            showPicture: false,
            is_anon: false,
            is_del: false,
            showUsername: function (author) {
                // this seems like a bad way to do it since this involves side effects
                this.is_del = false;
                this.is_anon = false;
                if (author && author.uid !== 'anon' && author.uid !== 'anonymous') {
                    if (author.uid === "_del") {
                        this.is_del = true;
                        return '[' + this.$$('deleted') + ']';
                    }
                    if (author.username) {
                        return author.username;
                    }
                }
                this.is_anon = true;
                return this.anon_name;
            }

        });
    </script>
</polymer-element>
